<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Tool/function calling</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Tool/function calling</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>One of the most interesting aspects of modern chat models is their
ability to make use of external tools that are defined by the
caller.</p>
<p>When making a chat request to the chat model, the caller advertises
one or more tools (defined by their function name, description, and a
list of expected arguments), and the chat model can choose to respond
with one or more “tool calls”. These tool calls are requests <em>from
the chat model to the caller</em> to execute the function with the given
arguments; the caller is expected to execute the functions and “return”
the results by submitting another chat request with the conversation so
far, plus the results. The chat model can then use those results in
formulating its response, or, it may decide to make additional tool
calls.</p>
<p><em>Note that the chat model does not directly execute any external
tools!</em> It only makes requests for the caller to execute them. It’s
easy to think that tool calling might work like this:</p>
<div class="float">
<img role="img" aria-label="Diagram showing the wrong mental model of tool calls: a user initiates a request that flows to the assistant, which then runs the code, and returns the result back to the user.”" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI4MTcuOTE5MjI1ODQ4MjIyIiBoZWlnaHQ9IjUxNi42ODU5MDczNDQ3MjcyIj48ZGVzYz50aXRsZSUyMEhvdyUyMHRvb2wlMjBjYWxsaW5nJTIwRE9FU04lRTIlODAlOTlUJTIwd29yayUwQSUwQWFjdG9yJTIwVXNlciUwQW1hdGVyaWFsZGVzaWduaWNvbnMlMjBGMTY3QSUyMEFzc2lzdGFudCUwQXBhcnRpY2lwYW50JTIwb3BlbndlYXRoZXIub3JnJTBBJTBBVXNlci0lM0VBc3Npc3RhbnQlM0ElMjAlN0IlNUNuJTIwJTIwcm9sZSUzQSUyMCUyMnVzZXIlMjIlMkMlNUNuJTIwJTIwY29udGVudCUzQSUyMCUyMldoYXQncyUyMHRoZSUyMHdlYXRoZXIlMjByaWdodCUyMG5vdyUyMGF0JTIwRmVud2F5JTIwUGFyayUzRiUyMiUyQyU1Q24lN0QlMEFBc3Npc3RhbnQtJTNFb3BlbndlYXRoZXIub3JnJTNBJTIwR0VUJTIwJTJGd2VhdGhlciUyRmN1cnJlbnQlMkZ1cyUyRjAyMjE1Lmpzb24lMEFvcGVud2VhdGhlci5vcmctJTNFQXNzaXN0YW50JTNBJTIwJTdCJTIydGVtcCUyMiUzQSUyMDY1JTJDJTIwJTIyY29uZGl0aW9ucyUyMiUzQSUyMCUyMnN1bm55JTIyJTdEJTBBQXNzaXN0YW50LSUzRVVzZXIlM0ElMjAlN0IlNUNuJTIwJTIwcm9sZSUzQSUyMCUyMmFzc2lzdGFudCUyMiUyQyU1Q24lMjAlMjBjb250ZW50JTNBJTIwJTIySXQncyUyMDY1JTIwZGVncmVlcyUyMGFuZCUyMHN1bm55JUUyJTgwJTk0YSUyMGJlYXV0aWZ1bCUyMGRheSElMjIlNUNuJTdEPC9kZXNjPjxkZWZzLz48Zz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGc+PHJlY3QgZmlsbD0id2hpdGUiIHN0cm9rZT0ibm9uZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjgxNyIgaGVpZ2h0PSI1MTYiLz48L2c+PGcvPjxnPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIHBhaW50LW9yZGVyPSJmaWxsIHN0cm9rZSBtYXJrZXJzIiBkPSIgTSAyNC4yNzg5NTE5MzQ1NTgxMDUgMTQzLjc0MDY1MDQ2NDcyNzI1IEwgMjQuMjc4OTUxOTM0NTU4MTA1IDUxNi42ODU5MDczNDQ3MjcyIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMS40NjU5Nzk3ODMzMzMzMzMyIiBzdHJva2UtZGFzaGFycmF5PSIxMy41MzIxMjEwNzY5MjMwNzYsNS44NjM5MTkxMzMzMzMzMzMiLz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gNDUyLjg4MTcyOTM3MTAzNjggMTQzLjc0MDY1MDQ2NDcyNzI1IEwgNDUyLjg4MTcyOTM3MTAzNjggNTE2LjY4NTkwNzM0NDcyNzIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxLjQ2NTk3OTc4MzMzMzMzMzIiIHN0cm9rZS1kYXNoYXJyYXk9IjEzLjUzMjEyMTA3NjkyMzA3Niw1Ljg2MzkxOTEzMzMzMzMzMyIvPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIHBhaW50LW9yZGVyPSJmaWxsIHN0cm9rZSBtYXJrZXJzIiBkPSIgTSA3MzUuMzk3OTQ2NTU4MTg2OCAxNDMuNzQwNjUwNDY0NzI3MjUgTCA3MzUuMzk3OTQ2NTU4MTg2OCA1MTYuNjg1OTA3MzQ0NzI3MiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEuNDY1OTc5NzgzMzMzMzMzMiIgc3Ryb2tlLWRhc2hhcnJheT0iMTMuNTMyMTIxMDc2OTIzMDc2LDUuODYzOTE5MTMzMzMzMzMzIi8+PC9nPjxnPjxnPjxwYXRoIGZpbGw9IndoaXRlIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gMzQuMzA2MjUzNjUyNTU4MTA1IDY5LjMyNzUxNjY2MjcyNzI2IEEgMTAuMDI3MzAxNzE3OTk5OTk5IDEwLjAyNzMwMTcxNzk5OTk5OSAwIDEgMSAzNC4zMDYyNDg2Mzg5MDc2NiA2OS4zMTc0ODkzNjI2ODA0OCBNIDI0LjI3ODk1MTkzNDU1ODEwNSA3OS4zNTQ4MTgzODA3MjcyNSBMIDI0LjI3ODk1MTkzNDU1ODEwNSAxMDAuODE2NzYyNDA4NzI3MjQgTSAxMS42MTI4ODY2MDY1NTgxMDYgODcuMDk1MTkxNjM2NzI3MjYgTCAzNi45NDUwMTcyNjI1NTgxIDg3LjA5NTE5MTYzNjcyNzI2IE0gMjQuMjc4OTUxOTM0NTU4MTA1IDEwMC44MTY3NjI0MDg3MjcyNCBMIDExLjYxMjg4NjYwNjU1ODEwNiAxMjAuODcxMzY1ODQ0NzI3MjUgTSAyNC4yNzg5NTE5MzQ1NTgxMDUgMTAwLjgxNjc2MjQwODcyNzI0IEwgMzYuOTQ1MDE3MjYyNTU4MSAxMjAuODcxMzY1ODQ0NzI3MjUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIyLjk5MDU5ODc1OCIgc3Ryb2tlLWRhc2hhcnJheT0iIi8+PC9nPjxnPjxnLz48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI4Ljc5NTg3ODciIHk9IjEzOC40NjMxMjMyNDQ3MjcyNiIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0iYWxwaGFiZXRpYyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+VXNlcjwvdGV4dD48L2c+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgaWQ9Im1kaS1yb2JvdC1vdXRsaW5lIiB3aWR0aD0iNjguMjU2MDE4NzEyIiBoZWlnaHQ9IjY4LjI1NjAxODcxMiIgeD0iNDE4Ljc1MzcyMDAxNTAzNjgiIHk9IjUyLjYxNTM0NzEzMjcyNzI1Ij48cGF0aCBkPSJNMTcuNSAxNS41QzE3LjUgMTYuNjEgMTYuNjEgMTcuNSAxNS41IDE3LjVTMTMuNSAxNi42MSAxMy41IDE1LjUgMTQuNCAxMy41IDE1LjUgMTMuNSAxNy41IDE0LjQgMTcuNSAxNS41TTguNSAxMy41QzcuNCAxMy41IDYuNSAxNC40IDYuNSAxNS41UzcuNCAxNy41IDguNSAxNy41IDEwLjUgMTYuNjEgMTAuNSAxNS41IDkuNjEgMTMuNSA4LjUgMTMuNU0yMyAxNVYxOEMyMyAxOC41NSAyMi41NSAxOSAyMiAxOUgyMVYyMEMyMSAyMS4xMSAyMC4xMSAyMiAxOSAyMkg1QzMuOSAyMiAzIDIxLjExIDMgMjBWMTlIMkMxLjQ1IDE5IDEgMTguNTUgMSAxOFYxNUMxIDE0LjQ1IDEuNDUgMTQgMiAxNEgzQzMgMTAuMTMgNi4xMyA3IDEwIDdIMTFWNS43M0MxMC40IDUuMzkgMTAgNC43NCAxMCA0QzEwIDIuOSAxMC45IDIgMTIgMlMxNCAyLjkgMTQgNEMxNCA0Ljc0IDEzLjYgNS4zOSAxMyA1LjczVjdIMTRDMTcuODcgNyAyMSAxMC4xMyAyMSAxNEgyMkMyMi41NSAxNCAyMyAxNC40NSAyMyAxNU0yMSAxNkgxOVYxNEMxOSAxMS4yNCAxNi43NiA5IDE0IDlIMTBDNy4yNCA5IDUgMTEuMjQgNSAxNFYxNkgzVjE3SDVWMjBIMTlWMTdIMjFWMTZaIi8+PC9zdmc+PGc+PGcvPjx0ZXh0IGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExcHQiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub3JtYWwiIHg9IjQyMy4xMjk0NDgxODIwNzE5NCIgeT0iMTM4LjQ2MzEyMzI0NDcyNzI2IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj5Bc3Npc3RhbnQ8L3RleHQ+PC9nPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0ibm9uZSIvPjxnPjxwYXRoIGZpbGw9IndoaXRlIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gNjYxLjY3MjU0NTk2ODE1MTcgOTYuMjQyOTA1NDg0NzI3MjYgTCA4MDkuMTIzMzQ3MTQ4MjIyIDk2LjI0MjkwNTQ4NDcyNzI2IEwgODA5LjEyMzM0NzE0ODIyMiAxNDMuNzQwNjUwNDY0NzI3MjUgTCA2NjEuNjcyNTQ1OTY4MTUxNyAxNDMuNzQwNjUwNDY0NzI3MjUgTCA2NjEuNjcyNTQ1OTY4MTUxNyA5Ni4yNDI5MDU0ODQ3MjcyNiBaIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMi44MTQ2ODExODQiIHN0cm9rZS1kYXNoYXJyYXk9IiIvPjwvZz48Zz48Zy8+PHRleHQgZmlsbD0iYmxhY2siIHN0cm9rZT0ibm9uZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTFwdCIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXdlaWdodD0ibm9ybWFsIiB0ZXh0LWRlY29yYXRpb249Im5vcm1hbCIgeD0iNjgwLjc1OTYwMjc0NzE1MTciIHk9IjEyNi4xNDg4OTMwNjQ3MjcyOCIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0iYWxwaGFiZXRpYyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+b3BlbndlYXRoZXIub3JnPC90ZXh0PjwvZz48L2c+PGc+PGc+PHRleHQgZmlsbD0iYmxhY2siIHN0cm9rZT0ibm9uZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTZwdCIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXdlaWdodD0ibm9ybWFsIiB0ZXh0LWRlY29yYXRpb249Im5vcm1hbCIgeD0iMjU4LjUzMTI0MjM3MDYwNTQ3IiB5PSIyNi41NDc1NjExNjcyNzI3MjUiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9ImFscGhhYmV0aWMiIHhtbDpzcGFjZT0icHJlc2VydmUiPkhvd8KgdG9vbMKgY2FsbGluZ8KgRE9FU07igJlUwqB3b3JrPC90ZXh0PjwvZz48Zz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSI0NS4wOTU4NjQ4NTc4OTE0NCIgeT0iMTc4LjkyNDE2NTI2NDcyNzI2IiB3aWR0aD0iMTAuMTc1OTY0NzIiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSI0NS4wOTU4NjQ4NTc4OTE0NCIgeT0iMTk2LjUxNTkyMjY2NDcyNzI3IiB3aWR0aD0iODkuMDUyMjY5MzQ2NDY0ODQiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSI0NS4wOTU4NjQ4NTc4OTE0NCIgeT0iMjE0LjEwNzY4MDA2NDcyNzI4IiB3aWR0aD0iMzg2Ljk2ODkzMzQ3IiBoZWlnaHQ9IjIyLjg2OTI4NDYyIi8+PHJlY3QgZmlsbD0id2hpdGUiIHN0cm9rZT0ibm9uZSIgeD0iNDUuMDk1ODY0ODU3ODkxNDQiIHk9IjIzMS42OTk0Mzc0NjQ3MjcyOCIgd2lkdGg9IjEwLjE3NTk2NDcyIiBoZWlnaHQ9IjIyLjg2OTI4NDYyIi8+PHRleHQgZmlsbD0iYmxhY2siIHN0cm9rZT0ibm9uZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTFwdCIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXdlaWdodD0ibm9ybWFsIiB0ZXh0LWRlY29yYXRpb249Im5vcm1hbCIgeD0iNDcuNzM0NjI4NDY3ODkxNDQiIHk9IjE5NC43NTY3NDY5MjQ3MjcyOCIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0iYWxwaGFiZXRpYyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+ezwvdGV4dD48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI0Ny43MzQ2Mjg0Njc4OTE0NCIgeT0iMjEyLjM0ODUwNDMyNDcyNzMiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9ImFscGhhYmV0aWMiIHhtbDpzcGFjZT0icHJlc2VydmUiPsKgwqByb2xlOsKgInVzZXIiLDwvdGV4dD48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI0Ny43MzQ2Mjg0Njc4OTE0NCIgeT0iMjI5Ljk0MDI2MTcyNDcyNzMiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9ImFscGhhYmV0aWMiIHhtbDpzcGFjZT0icHJlc2VydmUiPsKgwqBjb250ZW50OsKgIldoYXQnc8KgdGhlwqB3ZWF0aGVywqByaWdodMKgbm93wqBhdMKgRmVud2F5wqBQYXJrPyIsPC90ZXh0Pjx0ZXh0IGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExcHQiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub3JtYWwiIHg9IjQ3LjczNDYyODQ2Nzg5MTQ0IiB5PSIyNDcuNTMyMDE5MTI0NzI3MyIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0iYWxwaGFiZXRpYyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+fTwvdGV4dD48L2c+PGc+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgcGFpbnQtb3JkZXI9ImZpbGwgc3Ryb2tlIG1hcmtlcnMiIGQ9IiBNIDI0LjI3ODk1MTkzNDU1ODEwNSAyNTQuNTY4NzIyMDg0NzI3MjYgTCA0MzguMzk3ODQ5MTExNzAzNDcgMjU0LjU2ODcyMjA4NDcyNzI2IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMS40NjU5Nzk3ODMzMzMzMzMyIiBzdHJva2UtZGFzaGFycmF5PSIiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NTIuODgxNzI5MzcxMDM2OCwyNTQuNTY4NzIyMDg0NzI3MjYpIHRyYW5zbGF0ZSgtNDUyLjg4MTcyOTM3MTAzNjgsLTI1NC41Njg3MjIwODQ3MjcyNikiPjxwYXRoIGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIHBhaW50LW9yZGVyPSJzdHJva2UgZmlsbCBtYXJrZXJzIiBkPSIgTSA0MzguMjIxOTMxNTM3NzAzNCAyNDcuMjM4ODIzMTY4MDYwNTggTCA0NTIuODgxNzI5MzcxMDM2OCAyNTQuNTY4NzIyMDg0NzI3MjYgTCA0MzguMjIxOTMxNTM3NzAzNCAyNjEuODk4NjIxMDAxMzkzOSBaIi8+PC9nPjwvZz48Zz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSI0NzMuNjk4NjQyMjk0MzcwMTMiIHk9IjI4MC45NTYzNTgxODQ3MjcyNiIgd2lkdGg9IjI0MC42MjQ1ODgzNzcyMjY1NiIgaGVpZ2h0PSIyMi44NjkyODQ2MiIvPjx0ZXh0IGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExcHQiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub3JtYWwiIHg9IjQ3Ni4zMzc0MDU5MDQzNzAxNCIgeT0iMjk2Ljc4ODkzOTg0NDcyNzMiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9ImFscGhhYmV0aWMiIHhtbDpzcGFjZT0icHJlc2VydmUiPkdFVMKgL3dlYXRoZXIvY3VycmVudC91cy8wMjIxNS5qc29uPC90ZXh0PjwvZz48Zz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gNDUyLjg4MTcyOTM3MTAzNjggMzAzLjgyNTY0MjgwNDcyNzI0IEwgNzIwLjkxNDA2NjI5ODg1MzUgMzAzLjgyNTY0MjgwNDcyNzI0IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMS40NjU5Nzk3ODMzMzMzMzMyIiBzdHJva2UtZGFzaGFycmF5PSIiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg3MzUuMzk3OTQ2NTU4MTg2OCwzMDMuODI1NjQyODA0NzI3MjQpIHRyYW5zbGF0ZSgtNzM1LjM5Nzk0NjU1ODE4NjgsLTMwMy44MjU2NDI4MDQ3MjcyNCkiPjxwYXRoIGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIHBhaW50LW9yZGVyPSJzdHJva2UgZmlsbCBtYXJrZXJzIiBkPSIgTSA3MjAuNzM4MTQ4NzI0ODUzNSAyOTYuNDk1NzQzODg4MDYwNiBMIDczNS4zOTc5NDY1NTgxODY4IDMwMy44MjU2NDI4MDQ3MjcyNCBMIDcyMC43MzgxNDg3MjQ4NTM1IDMxMS4xNTU1NDE3MjEzOTM5IFoiLz48L2c+PC9nPjxnPjxyZWN0IGZpbGw9IndoaXRlIiBzdHJva2U9Im5vbmUiIHg9IjQ4MS43MDg3NTAyODg0NDk3IiB5PSIzMzAuMjEzMjc4OTA0NzI3MjUiIHdpZHRoPSIyMjQuODYyMTUyNDY0MTQwNjIiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI0ODQuMzQ3NTEzODk4NDQ5NzMiIHk9IjM0Ni4wNDU4NjA1NjQ3MjcyNiIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0iYWxwaGFiZXRpYyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+eyJ0ZW1wIjrCoDY1LMKgImNvbmRpdGlvbnMiOsKgInN1bm55In08L3RleHQ+PC9nPjxnPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIHBhaW50LW9yZGVyPSJmaWxsIHN0cm9rZSBtYXJrZXJzIiBkPSIgTSA3MzUuMzk3OTQ2NTU4MTg2OCAzNTMuMDgyNTYzNTI0NzI3MiBMIDQ2Ny4zNjU2MDk2MzAzNzAxIDM1My4wODI1NjM1MjQ3MjcyIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMS40NjU5Nzk3ODMzMzMzMzMyIiBzdHJva2UtZGFzaGFycmF5PSIiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NTIuODgxNzI5MzcxMDM2OCwzNTMuMDgyNTYzNTI0NzI3MikgdHJhbnNsYXRlKC00NTIuODgxNzI5MzcxMDM2OCwtMzUzLjA4MjU2MzUyNDcyNzIpIj48cGF0aCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBwYWludC1vcmRlcj0ic3Ryb2tlIGZpbGwgbWFya2VycyIgZD0iIE0gNDY3LjU0MTUyNzIwNDM3MDE0IDM0NS43NTI2NjQ2MDgwNjA1NyBMIDQ1Mi44ODE3MjkzNzEwMzY4IDM1My4wODI1NjM1MjQ3MjcyIEwgNDY3LjU0MTUyNzIwNDM3MDE0IDM2MC40MTI0NjI0NDEzOTM4NyBaIi8+PC9nPjwvZz48Zz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSI1Ny43MDM2MDgxMjExMzYwNyIgeT0iMzc5LjQ3MDE5OTYyNDcyNzIzIiB3aWR0aD0iMTAuMTc1OTY0NzIiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSI1Ny43MDM2MDgxMjExMzYwNyIgeT0iMzk3LjA2MTk1NzAyNDcyNzIzIiB3aWR0aD0iMTE4LjM5OTkxNzk2NzA3MDMxIiBoZWlnaHQ9IjIyLjg2OTI4NDYyIi8+PHJlY3QgZmlsbD0id2hpdGUiIHN0cm9rZT0ibm9uZSIgeD0iNTcuNzAzNjA4MTIxMTM2MDciIHk9IjQxNC42NTM3MTQ0MjQ3MjcyNCIgd2lkdGg9IjM2MS43NTMzNTcyOTgxMjUiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSI1Ny43MDM2MDgxMjExMzYwNyIgeT0iNDMyLjI0NTQ3MTgyNDcyNzI1IiB3aWR0aD0iMTAuMTc1OTY0NzIiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI2MC4zNDIzNzE3MzExMzYwNyIgeT0iMzk1LjMwMjc4MTI4NDcyNzI1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj57PC90ZXh0Pjx0ZXh0IGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExcHQiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub3JtYWwiIHg9IjYwLjM0MjM3MTczMTEzNjA3IiB5PSI0MTIuODk0NTM4Njg0NzI3MjUiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9ImFscGhhYmV0aWMiIHhtbDpzcGFjZT0icHJlc2VydmUiPsKgwqByb2xlOsKgImFzc2lzdGFudCIsPC90ZXh0Pjx0ZXh0IGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExcHQiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub3JtYWwiIHg9IjYwLjM0MjM3MTczMTEzNjA3IiB5PSI0MzAuNDg2Mjk2MDg0NzI3MjYiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9ImFscGhhYmV0aWMiIHhtbDpzcGFjZT0icHJlc2VydmUiPsKgwqBjb250ZW50OsKgIkl0J3PCoDY1wqBkZWdyZWVzwqBhbmTCoHN1bm554oCUYcKgYmVhdXRpZnVswqBkYXkhIjwvdGV4dD48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI2MC4zNDIzNzE3MzExMzYwNyIgeT0iNDQ4LjA3ODA1MzQ4NDcyNzI2IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj59PC90ZXh0PjwvZz48Zz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gNDUyLjg4MTcyOTM3MTAzNjggNDU1LjExNDc1NjQ0NDcyNzIgTCAzOC43NjI4MzIxOTM4OTE0NCA0NTUuMTE0NzU2NDQ0NzI3MiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEuNDY1OTc5NzgzMzMzMzMzMiIgc3Ryb2tlLWRhc2hhcnJheT0iIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjQuMjc4OTUxOTM0NTU4MTA1LDQ1NS4xMTQ3NTY0NDQ3MjcyKSB0cmFuc2xhdGUoLTI0LjI3ODk1MTkzNDU1ODEwNSwtNDU1LjExNDc1NjQ0NDcyNzIpIj48cGF0aCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBwYWludC1vcmRlcj0ic3Ryb2tlIGZpbGwgbWFya2VycyIgZD0iIE0gMzguOTM4NzQ5NzY3ODkxNDQgNDQ3Ljc4NDg1NzUyODA2MDU3IEwgMjQuMjc4OTUxOTM0NTU4MTA1IDQ1NS4xMTQ3NTY0NDQ3MjcyIEwgMzguOTM4NzQ5NzY3ODkxNDQgNDYyLjQ0NDY1NTM2MTM5Mzg3IFoiLz48L2c+PC9nPjwvZz48Zy8+PGcvPjxnLz48L2c+PC9zdmc+" alt="Diagram showing the wrong mental model of tool calls: a user initiates a request that flows to the assistant, which then runs the code, and returns the result back to the user.”" />
<div class="figcaption">Diagram showing the wrong mental model of tool
calls: a user initiates a request that flows to the assistant, which
then runs the code, and returns the result back to the user.”</div>
</div>
<p>But in fact it works like this:</p>
<div class="float">
<img role="img" aria-label="Diagram showing the correct mental model for tool calls: a user sends a request that needs a tool call, the assistant requests that the user runs that tool, returns the result to the assistant, which uses it to generate the final answer." src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI4MzYuNTY0MTYxOTY5NjYzOSIgaGVpZ2h0PSI2MzIuNzkxNTA2MTg0NzI3MiI+PGRlc2M+dGl0bGUlMjBIb3clMjB0b29sJTIwY2FsbGluZyUyMERPRVMlMjB3b3JrJTBBJTBBcGFydGljaXBhbnQlMjBvcGVud2VhdGhlci5vcmclMEFhY3RvciUyMFVzZXIlMEFtYXRlcmlhbGRlc2lnbmljb25zJTIwRjE2N0ElMjBBc3Npc3RhbnQlMEElMEFVc2VyLSUzRUFzc2lzdGFudCUzQSUyMCU3QiU1Q24lMjAlMjByb2xlJTNBJTIwJTIydXNlciUyMiUyQyU1Q24lMjAlMjBjb250ZW50JTNBJTIwJTIyV2hhdCdzJTIwdGhlJTIwd2VhdGhlciUyMHJpZ2h0JTIwbm93JTIwYXQlMjBGZW53YXklMjBQYXJrJTNGJTIyJTJDJTVDbiUyMCUyMHRvb2xzJTNBJTIwJTVCZ2V0X2N1cnJlbnRfd2VhdGhlciU1RCU1Q24lN0QlMEFBc3Npc3RhbnQtJTNFVXNlciUzQSUyMENBTEwlMjBnZXRfY3VycmVudF93ZWF0aGVyKCUyMjAyMjE1JTIyKSUwQVVzZXItJTNFb3BlbndlYXRoZXIub3JnJTNBJTIwR0VUJTIwJTJGd2VhdGhlciUyRmN1cnJlbnQlMkZ1cyUyRjAyMjE1Lmpzb24lMEFvcGVud2VhdGhlci5vcmctJTNFVXNlciUzQSUyMCU3QiUyMnRlbXAlMjIlM0ElMjA2NSUyQyUyMCUyMmNvbmRpdGlvbnMlMjIlM0ElMjAlMjJzdW5ueSUyMiU3RCUwQVVzZXItJTNFQXNzaXN0YW50JTNBJTIwUkVUVVJOJTIwJTdCJTIydGVtcCUyMiUzQSUyMDY1JTJDJTIwJTIyY29uZGl0aW9ucyUyMiUzQSUyMCUyMnN1bm55JTIyJTdEJTBBQXNzaXN0YW50LSUzRVVzZXIlM0ElMjAlN0IlNUNuJTIwJTIwcm9sZSUzQSUyMCUyMmFzc2lzdGFudCUyMiUyQyU1Q24lMjAlMjBjb250ZW50JTNBJTIwJTIySXQncyUyMDY1JTIwZGVncmVlcyUyMGFuZCUyMHN1bm55JUUyJTgwJTk0YSUyMGJlYXV0aWZ1bCUyMGRheSElMjIlNUNuJTdEPC9kZXNjPjxkZWZzLz48Zz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnLz48Zy8+PGcvPjxnPjxyZWN0IGZpbGw9IndoaXRlIiBzdHJva2U9Im5vbmUiIHg9IjAiIHk9IjAiIHdpZHRoPSI4MzYiIGhlaWdodD0iNjMyIi8+PC9nPjxnLz48Zz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gODIuNTIxMjc5MjkwMDM1MTcgMTQzLjc0MDY1MDQ2NDcyNzI1IEwgODIuNTIxMjc5MjkwMDM1MTcgNjMyLjc5MTUwNjE4NDcyNzIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxLjQ2NTk3OTc4MzMzMzMzMzIiIHN0cm9rZS1kYXNoYXJyYXk9IjEzLjUzMjEyMTA3NjkyMzA3Niw1Ljg2MzkxOTEzMzMzMzMzMyIvPjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIHBhaW50LW9yZGVyPSJmaWxsIHN0cm9rZSBtYXJrZXJzIiBkPSIgTSAzNjUuMDM3NDk2NDc3MTg1MjQgMTQzLjc0MDY1MDQ2NDcyNzI1IEwgMzY1LjAzNzQ5NjQ3NzE4NTI0IDYzMi43OTE1MDYxODQ3MjcyIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMS40NjU5Nzk3ODMzMzMzMzMyIiBzdHJva2UtZGFzaGFycmF5PSIxMy41MzIxMjEwNzY5MjMwNzYsNS44NjM5MTkxMzMzMzMzMzMiLz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gNzkzLjY0MDI3MzkxMzY2MzkgMTQzLjc0MDY1MDQ2NDcyNzI1IEwgNzkzLjY0MDI3MzkxMzY2MzkgNjMyLjc5MTUwNjE4NDcyNzIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxLjQ2NTk3OTc4MzMzMzMzMzIiIHN0cm9rZS1kYXNoYXJyYXk9IjEzLjUzMjEyMTA3NjkyMzA3Niw1Ljg2MzkxOTEzMzMzMzMzMyIvPjwvZz48Zz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9Im5vbmUiLz48Zz48cGF0aCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJibGFjayIgcGFpbnQtb3JkZXI9ImZpbGwgc3Ryb2tlIG1hcmtlcnMiIGQ9IiBNIDguNzk1ODc4NzAwMDAwMDAzIDk2LjI0MjkwNTQ4NDcyNzI2IEwgMTU2LjI0NjY3OTg4MDA3MDMzIDk2LjI0MjkwNTQ4NDcyNzI2IEwgMTU2LjI0NjY3OTg4MDA3MDMzIDE0My43NDA2NTA0NjQ3MjcyNSBMIDguNzk1ODc4NzAwMDAwMDAzIDE0My43NDA2NTA0NjQ3MjcyNSBMIDguNzk1ODc4NzAwMDAwMDAzIDk2LjI0MjkwNTQ4NDcyNzI2IFoiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIyLjgxNDY4MTE4NCIgc3Ryb2tlLWRhc2hhcnJheT0iIi8+PC9nPjxnPjxnLz48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSIyNy44ODI5MzU0NzkwMDAwMSIgeT0iMTI2LjE0ODg5MzA2NDcyNzI4IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj5vcGVud2VhdGhlci5vcmc8L3RleHQ+PC9nPjxnPjxwYXRoIGZpbGw9IndoaXRlIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gMzc1LjA2NDc5ODE5NTE4NTIzIDY5LjMyNzUxNjY2MjcyNzI2IEEgMTAuMDI3MzAxNzE3OTk5OTk5IDEwLjAyNzMwMTcxNzk5OTk5OSAwIDEgMSAzNzUuMDY0NzkzMTgxNTM0OCA2OS4zMTc0ODkzNjI2ODA0OCBNIDM2NS4wMzc0OTY0NzcxODUyNCA3OS4zNTQ4MTgzODA3MjcyNSBMIDM2NS4wMzc0OTY0NzcxODUyNCAxMDAuODE2NzYyNDA4NzI3MjQgTSAzNTIuMzcxNDMxMTQ5MTg1MjQgODcuMDk1MTkxNjM2NzI3MjYgTCAzNzcuNzAzNTYxODA1MTg1MjUgODcuMDk1MTkxNjM2NzI3MjYgTSAzNjUuMDM3NDk2NDc3MTg1MjQgMTAwLjgxNjc2MjQwODcyNzI0IEwgMzUyLjM3MTQzMTE0OTE4NTI0IDEyMC44NzEzNjU4NDQ3MjcyNSBNIDM2NS4wMzc0OTY0NzcxODUyNCAxMDAuODE2NzYyNDA4NzI3MjQgTCAzNzcuNzAzNTYxODA1MTg1MjUgMTIwLjg3MTM2NTg0NDcyNzI1IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMi45OTA1OTg3NTgiIHN0cm9rZS1kYXNoYXJyYXk9IiIvPjwvZz48Zz48Zy8+PHRleHQgZmlsbD0iYmxhY2siIHN0cm9rZT0ibm9uZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTFwdCIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXdlaWdodD0ibm9ybWFsIiB0ZXh0LWRlY29yYXRpb249Im5vcm1hbCIgeD0iMzQ5LjU1NDQyMzI0MjYyNzE0IiB5PSIxMzguNDYzMTIzMjQ0NzI3MjYiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9ImFscGhhYmV0aWMiIHhtbDpzcGFjZT0icHJlc2VydmUiPlVzZXI8L3RleHQ+PC9nPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGlkPSJtZGktcm9ib3Qtb3V0bGluZSIgd2lkdGg9IjY4LjI1NjAxODcxMiIgaGVpZ2h0PSI2OC4yNTYwMTg3MTIiIHg9Ijc1OS41MTIyNjQ1NTc2NjM5IiB5PSI1Mi42MTUzNDcxMzI3MjcyNSI+PHBhdGggZD0iTTE3LjUgMTUuNUMxNy41IDE2LjYxIDE2LjYxIDE3LjUgMTUuNSAxNy41UzEzLjUgMTYuNjEgMTMuNSAxNS41IDE0LjQgMTMuNSAxNS41IDEzLjUgMTcuNSAxNC40IDE3LjUgMTUuNU04LjUgMTMuNUM3LjQgMTMuNSA2LjUgMTQuNCA2LjUgMTUuNVM3LjQgMTcuNSA4LjUgMTcuNSAxMC41IDE2LjYxIDEwLjUgMTUuNSA5LjYxIDEzLjUgOC41IDEzLjVNMjMgMTVWMThDMjMgMTguNTUgMjIuNTUgMTkgMjIgMTlIMjFWMjBDMjEgMjEuMTEgMjAuMTEgMjIgMTkgMjJINUMzLjkgMjIgMyAyMS4xMSAzIDIwVjE5SDJDMS40NSAxOSAxIDE4LjU1IDEgMThWMTVDMSAxNC40NSAxLjQ1IDE0IDIgMTRIM0MzIDEwLjEzIDYuMTMgNyAxMCA3SDExVjUuNzNDMTAuNCA1LjM5IDEwIDQuNzQgMTAgNEMxMCAyLjkgMTAuOSAyIDEyIDJTMTQgMi45IDE0IDRDMTQgNC43NCAxMy42IDUuMzkgMTMgNS43M1Y3SDE0QzE3Ljg3IDcgMjEgMTAuMTMgMjEgMTRIMjJDMjIuNTUgMTQgMjMgMTQuNDUgMjMgMTVNMjEgMTZIMTlWMTRDMTkgMTEuMjQgMTYuNzYgOSAxNCA5SDEwQzcuMjQgOSA1IDExLjI0IDUgMTRWMTZIM1YxN0g1VjIwSDE5VjE3SDIxVjE2WiIvPjwvc3ZnPjxnPjxnLz48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI3NjMuODg3OTkyNzI0Njk5MSIgeT0iMTM4LjQ2MzEyMzI0NDcyNzI2IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj5Bc3Npc3RhbnQ8L3RleHQ+PC9nPjwvZz48Zz48Zz48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNnB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSIyODQuNjE5Nzg1MzA4ODM3OSIgeT0iMjYuNTQ3NTYxMTY3MjcyNzI1IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj5Ib3fCoHRvb2zCoGNhbGxpbmfCoERPRVPCoHdvcms8L3RleHQ+PC9nPjxnPjxyZWN0IGZpbGw9IndoaXRlIiBzdHJva2U9Im5vbmUiIHg9IjM4NS44NTQ0MDk0MDA1MTg2IiB5PSIxNzguOTI0MTY1MjY0NzI3MjYiIHdpZHRoPSIxMC4xNzU5NjQ3MiIgaGVpZ2h0PSIyMi44NjkyODQ2MiIvPjxyZWN0IGZpbGw9IndoaXRlIiBzdHJva2U9Im5vbmUiIHg9IjM4NS44NTQ0MDk0MDA1MTg2IiB5PSIxOTYuNTE1OTIyNjY0NzI3MjciIHdpZHRoPSI4OS4wNTIyNjkzNDY0NjQ4NCIgaGVpZ2h0PSIyMi44NjkyODQ2MiIvPjxyZWN0IGZpbGw9IndoaXRlIiBzdHJva2U9Im5vbmUiIHg9IjM4NS44NTQ0MDk0MDA1MTg2IiB5PSIyMTQuMTA3NjgwMDY0NzI3MjgiIHdpZHRoPSIzODYuOTY4OTMzNDciIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSIzODUuODU0NDA5NDAwNTE4NiIgeT0iMjMxLjY5OTQzNzQ2NDcyNzI4IiB3aWR0aD0iMTk1LjIzNTIyOTg1NjcxODc1IiBoZWlnaHQ9IjIyLjg2OTI4NDYyIi8+PHJlY3QgZmlsbD0id2hpdGUiIHN0cm9rZT0ibm9uZSIgeD0iMzg1Ljg1NDQwOTQwMDUxODYiIHk9IjI0OS4yOTExOTQ4NjQ3MjczIiB3aWR0aD0iMTAuMTc1OTY0NzIiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSIzODguNDkzMTczMDEwNTE4NiIgeT0iMTk0Ljc1Njc0NjkyNDcyNzI4IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj57PC90ZXh0Pjx0ZXh0IGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExcHQiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub3JtYWwiIHg9IjM4OC40OTMxNzMwMTA1MTg2IiB5PSIyMTIuMzQ4NTA0MzI0NzI3MyIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0iYWxwaGFiZXRpYyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+wqDCoHJvbGU6wqAidXNlciIsPC90ZXh0Pjx0ZXh0IGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExcHQiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub3JtYWwiIHg9IjM4OC40OTMxNzMwMTA1MTg2IiB5PSIyMjkuOTQwMjYxNzI0NzI3MyIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0iYWxwaGFiZXRpYyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+wqDCoGNvbnRlbnQ6wqAiV2hhdCdzwqB0aGXCoHdlYXRoZXLCoHJpZ2h0wqBub3fCoGF0wqBGZW53YXnCoFBhcms/Iiw8L3RleHQ+PHRleHQgZmlsbD0iYmxhY2siIHN0cm9rZT0ibm9uZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTFwdCIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXdlaWdodD0ibm9ybWFsIiB0ZXh0LWRlY29yYXRpb249Im5vcm1hbCIgeD0iMzg4LjQ5MzE3MzAxMDUxODYiIHk9IjI0Ny41MzIwMTkxMjQ3MjczIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj7CoMKgdG9vbHM6wqBbZ2V0X2N1cnJlbnRfd2VhdGhlcl08L3RleHQ+PHRleHQgZmlsbD0iYmxhY2siIHN0cm9rZT0ibm9uZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTFwdCIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXdlaWdodD0ibm9ybWFsIiB0ZXh0LWRlY29yYXRpb249Im5vcm1hbCIgeD0iMzg4LjQ5MzE3MzAxMDUxODYiIHk9IjI2NS4xMjM3NzY1MjQ3MjczIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj59PC90ZXh0PjwvZz48Zz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gMzY1LjAzNzQ5NjQ3NzE4NTI0IDI3Mi4xNjA0Nzk0ODQ3MjcyNiBMIDc3OS4xNTYzOTM2NTQzMzA2IDI3Mi4xNjA0Nzk0ODQ3MjcyNiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEuNDY1OTc5NzgzMzMzMzMzMiIgc3Ryb2tlLWRhc2hhcnJheT0iIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzkzLjY0MDI3MzkxMzY2MzksMjcyLjE2MDQ3OTQ4NDcyNzI2KSB0cmFuc2xhdGUoLTc5My42NDAyNzM5MTM2NjM5LC0yNzIuMTYwNDc5NDg0NzI3MjYpIj48cGF0aCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBwYWludC1vcmRlcj0ic3Ryb2tlIGZpbGwgbWFya2VycyIgZD0iIE0gNzc4Ljk4MDQ3NjA4MDMzMDYgMjY0LjgzMDU4MDU2ODA2MDYgTCA3OTMuNjQwMjczOTEzNjYzOSAyNzIuMTYwNDc5NDg0NzI3MjYgTCA3NzguOTgwNDc2MDgwMzMwNiAyNzkuNDkwMzc4NDAxMzkzOSBaIi8+PC9nPjwvZz48Zz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSI0NTguNTcxODczMzcwNzAyOSIgeT0iMjk4LjU0ODExNTU4NDcyNzI3IiB3aWR0aD0iMjQwLjk5Njk2Mzg2NTUwNzgiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI0NjEuMjEwNjM2OTgwNzAyOTMiIHk9IjMxNC4zODA2OTcyNDQ3MjczIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj5DQUxMwqBnZXRfY3VycmVudF93ZWF0aGVyKCIwMjIxNSIpPC90ZXh0PjwvZz48Zz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gNzkzLjY0MDI3MzkxMzY2MzkgMzIxLjQxNzQwMDIwNDcyNzI0IEwgMzc5LjUyMTM3NjczNjUxODU2IDMyMS40MTc0MDAyMDQ3MjcyNCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEuNDY1OTc5NzgzMzMzMzMzMiIgc3Ryb2tlLWRhc2hhcnJheT0iIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzY1LjAzNzQ5NjQ3NzE4NTI0LDMyMS40MTc0MDAyMDQ3MjcyNCkgdHJhbnNsYXRlKC0zNjUuMDM3NDk2NDc3MTg1MjQsLTMyMS40MTc0MDAyMDQ3MjcyNCkiPjxwYXRoIGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIHBhaW50LW9yZGVyPSJzdHJva2UgZmlsbCBtYXJrZXJzIiBkPSIgTSAzNzkuNjk3Mjk0MzEwNTE4NiAzMTQuMDg3NTAxMjg4MDYwNiBMIDM2NS4wMzc0OTY0NzcxODUyNCAzMjEuNDE3NDAwMjA0NzI3MjQgTCAzNzkuNjk3Mjk0MzEwNTE4NiAzMjguNzQ3Mjk5MTIxMzkzOSBaIi8+PC9nPjwvZz48Zz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSIxMDMuMzM4MTkyMjEzMzY4NDkiIHk9IjM0Ny44MDUwMzYzMDQ3MjcyNSIgd2lkdGg9IjI0MC42MjQ1ODgzNzcyMjY1NiIgaGVpZ2h0PSIyMi44NjkyODQ2MiIvPjx0ZXh0IGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExcHQiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub3JtYWwiIHg9IjEwNS45NzY5NTU4MjMzNjg0OCIgeT0iMzYzLjYzNzYxNzk2NDcyNzI3IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj5HRVTCoC93ZWF0aGVyL2N1cnJlbnQvdXMvMDIyMTUuanNvbjwvdGV4dD48L2c+PGc+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgcGFpbnQtb3JkZXI9ImZpbGwgc3Ryb2tlIG1hcmtlcnMiIGQ9IiBNIDM2NS4wMzc0OTY0NzcxODUyNCAzNzAuNjc0MzIwOTI0NzI3MiBMIDk3LjAwNTE1OTU0OTM2ODUgMzcwLjY3NDMyMDkyNDcyNzIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxLjQ2NTk3OTc4MzMzMzMzMzIiIHN0cm9rZS1kYXNoYXJyYXk9IiIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgyLjUyMTI3OTI5MDAzNTE3LDM3MC42NzQzMjA5MjQ3MjcyKSB0cmFuc2xhdGUoLTgyLjUyMTI3OTI5MDAzNTE3LC0zNzAuNjc0MzIwOTI0NzI3MikiPjxwYXRoIGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIHBhaW50LW9yZGVyPSJzdHJva2UgZmlsbCBtYXJrZXJzIiBkPSIgTSA5Ny4xODEwNzcxMjMzNjg1IDM2My4zNDQ0MjIwMDgwNjA2IEwgODIuNTIxMjc5MjkwMDM1MTcgMzcwLjY3NDMyMDkyNDcyNzIgTCA5Ny4xODEwNzcxMjMzNjg1IDM3OC4wMDQyMTk4NDEzOTM5IFoiLz48L2c+PC9nPjxnPjxyZWN0IGZpbGw9IndoaXRlIiBzdHJva2U9Im5vbmUiIHg9IjExMS4zNDgzMDAyMDc0NDgwOCIgeT0iMzk3LjA2MTk1NzAyNDcyNzIzIiB3aWR0aD0iMjI0Ljg2MjE1MjQ2NDE0MDYyIiBoZWlnaHQ9IjIyLjg2OTI4NDYyIi8+PHRleHQgZmlsbD0iYmxhY2siIHN0cm9rZT0ibm9uZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTFwdCIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXdlaWdodD0ibm9ybWFsIiB0ZXh0LWRlY29yYXRpb249Im5vcm1hbCIgeD0iMTEzLjk4NzA2MzgxNzQ0ODA3IiB5PSI0MTIuODk0NTM4Njg0NzI3MjUiIHRleHQtYW5jaG9yPSJzdGFydCIgZG9taW5hbnQtYmFzZWxpbmU9ImFscGhhYmV0aWMiIHhtbDpzcGFjZT0icHJlc2VydmUiPnsidGVtcCI6wqA2NSzCoCJjb25kaXRpb25zIjrCoCJzdW5ueSJ9PC90ZXh0PjwvZz48Zz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gODIuNTIxMjc5MjkwMDM1MTcgNDE5LjkzMTI0MTY0NDcyNzIgTCAzNTAuNTUzNjE2MjE3ODUxOSA0MTkuOTMxMjQxNjQ0NzI3MiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEuNDY1OTc5NzgzMzMzMzMzMiIgc3Ryb2tlLWRhc2hhcnJheT0iIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzY1LjAzNzQ5NjQ3NzE4NTI0LDQxOS45MzEyNDE2NDQ3MjcyKSB0cmFuc2xhdGUoLTM2NS4wMzc0OTY0NzcxODUyNCwtNDE5LjkzMTI0MTY0NDcyNzIpIj48cGF0aCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBwYWludC1vcmRlcj0ic3Ryb2tlIGZpbGwgbWFya2VycyIgZD0iIE0gMzUwLjM3NzY5ODY0Mzg1MTkgNDEyLjYwMTM0MjcyODA2MDU2IEwgMzY1LjAzNzQ5NjQ3NzE4NTI0IDQxOS45MzEyNDE2NDQ3MjcyIEwgMzUwLjM3NzY5ODY0Mzg1MTkgNDI3LjI2MTE0MDU2MTM5Mzg2IFoiLz48L2c+PC9nPjxnPjxyZWN0IGZpbGw9IndoaXRlIiBzdHJva2U9Im5vbmUiIHg9IjQzNC4zMTU5OTg3MzY5MTM4NSIgeT0iNDQ2LjMxODg3Nzc0NDcyNzIiIHdpZHRoPSIyOTAuMDQ1ODA3MjQ5Mjk2OSIgaGVpZ2h0PSIyMi44NjkyODQ2MiIvPjx0ZXh0IGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExcHQiIGZvbnQtc3R5bGU9Im5vcm1hbCIgZm9udC13ZWlnaHQ9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub3JtYWwiIHg9IjQzNi45NTQ3NjIzNDY5MTM4NyIgeT0iNDYyLjE1MTQ1OTQwNDcyNzIzIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj5SRVRVUk7CoHsidGVtcCI6wqA2NSzCoCJjb25kaXRpb25zIjrCoCJzdW5ueSJ9PC90ZXh0PjwvZz48Zz48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBwYWludC1vcmRlcj0iZmlsbCBzdHJva2UgbWFya2VycyIgZD0iIE0gMzY1LjAzNzQ5NjQ3NzE4NTI0IDQ2OS4xODgxNjIzNjQ3MjcyIEwgNzc5LjE1NjM5MzY1NDMzMDYgNDY5LjE4ODE2MjM2NDcyNzIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxLjQ2NTk3OTc4MzMzMzMzMzIiIHN0cm9rZS1kYXNoYXJyYXk9IiIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDc5My42NDAyNzM5MTM2NjM5LDQ2OS4xODgxNjIzNjQ3MjcyKSB0cmFuc2xhdGUoLTc5My42NDAyNzM5MTM2NjM5LC00NjkuMTg4MTYyMzY0NzI3MikiPjxwYXRoIGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIHBhaW50LW9yZGVyPSJzdHJva2UgZmlsbCBtYXJrZXJzIiBkPSIgTSA3NzguOTgwNDc2MDgwMzMwNiA0NjEuODU4MjYzNDQ4MDYwNTQgTCA3OTMuNjQwMjczOTEzNjYzOSA0NjkuMTg4MTYyMzY0NzI3MiBMIDc3OC45ODA0NzYwODAzMzA2IDQ3Ni41MTgwNjEyODEzOTM4NCBaIi8+PC9nPjwvZz48Zz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSIzOTguNDYyMTUyNjYzNzYzMiIgeT0iNDk1LjU3NTc5ODQ2NDcyNzE0IiB3aWR0aD0iMTAuMTc1OTY0NzIiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSIzOTguNDYyMTUyNjYzNzYzMiIgeT0iNTEzLjE2NzU1NTg2NDcyNzIiIHdpZHRoPSIxMTguMzk5OTE3OTY3MDcwMzEiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48cmVjdCBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiB4PSIzOTguNDYyMTUyNjYzNzYzMiIgeT0iNTMwLjc1OTMxMzI2NDcyNzIiIHdpZHRoPSIzNjEuNzUzMzU3Mjk4MTI1IiBoZWlnaHQ9IjIyLjg2OTI4NDYyIi8+PHJlY3QgZmlsbD0id2hpdGUiIHN0cm9rZT0ibm9uZSIgeD0iMzk4LjQ2MjE1MjY2Mzc2MzIiIHk9IjU0OC4zNTEwNzA2NjQ3MjcyIiB3aWR0aD0iMTAuMTc1OTY0NzIiIGhlaWdodD0iMjIuODY5Mjg0NjIiLz48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI0MDEuMTAwOTE2MjczNzYzMjMiIHk9IjUxMS40MDgzODAxMjQ3MjcxNiIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0iYWxwaGFiZXRpYyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+ezwvdGV4dD48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI0MDEuMTAwOTE2MjczNzYzMjMiIHk9IjUyOS4wMDAxMzc1MjQ3MjcyIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj7CoMKgcm9sZTrCoCJhc3Npc3RhbnQiLDwvdGV4dD48dGV4dCBmaWxsPSJibGFjayIgc3Ryb2tlPSJub25lIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMXB0IiBmb250LXN0eWxlPSJub3JtYWwiIGZvbnQtd2VpZ2h0PSJub3JtYWwiIHRleHQtZGVjb3JhdGlvbj0ibm9ybWFsIiB4PSI0MDEuMTAwOTE2MjczNzYzMjMiIHk9IjU0Ni41OTE4OTQ5MjQ3MjcyIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRvbWluYW50LWJhc2VsaW5lPSJhbHBoYWJldGljIiB4bWw6c3BhY2U9InByZXNlcnZlIj7CoMKgY29udGVudDrCoCJJdCdzwqA2NcKgZGVncmVlc8KgYW5kwqBzdW5ueeKAlGHCoGJlYXV0aWZ1bMKgZGF5ISI8L3RleHQ+PHRleHQgZmlsbD0iYmxhY2siIHN0cm9rZT0ibm9uZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTFwdCIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXdlaWdodD0ibm9ybWFsIiB0ZXh0LWRlY29yYXRpb249Im5vcm1hbCIgeD0iNDAxLjEwMDkxNjI3Mzc2MzIzIiB5PSI1NjQuMTgzNjUyMzI0NzI3MiIgdGV4dC1hbmNob3I9InN0YXJ0IiBkb21pbmFudC1iYXNlbGluZT0iYWxwaGFiZXRpYyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+fTwvdGV4dD48L2c+PGc+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgcGFpbnQtb3JkZXI9ImZpbGwgc3Ryb2tlIG1hcmtlcnMiIGQ9IiBNIDc5My42NDAyNzM5MTM2NjM5IDU3MS4yMjAzNTUyODQ3MjcxIEwgMzc5LjUyMTM3NjczNjUxODU2IDU3MS4yMjAzNTUyODQ3MjcxIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMS40NjU5Nzk3ODMzMzMzMzMyIiBzdHJva2UtZGFzaGFycmF5PSIiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNjUuMDM3NDk2NDc3MTg1MjQsNTcxLjIyMDM1NTI4NDcyNzEpIHRyYW5zbGF0ZSgtMzY1LjAzNzQ5NjQ3NzE4NTI0LC01NzEuMjIwMzU1Mjg0NzI3MSkiPjxwYXRoIGZpbGw9ImJsYWNrIiBzdHJva2U9Im5vbmUiIHBhaW50LW9yZGVyPSJzdHJva2UgZmlsbCBtYXJrZXJzIiBkPSIgTSAzNzkuNjk3Mjk0MzEwNTE4NiA1NjMuODkwNDU2MzY4MDYwNCBMIDM2NS4wMzc0OTY0NzcxODUyNCA1NzEuMjIwMzU1Mjg0NzI3MSBMIDM3OS42OTcyOTQzMTA1MTg2IDU3OC41NTAyNTQyMDEzOTM4IFoiLz48L2c+PC9nPjwvZz48Zy8+PGcvPjxnLz48L2c+PC9zdmc+" alt="Diagram showing the correct mental model for tool calls: a user sends a request that needs a tool call, the assistant requests that the user runs that tool, returns the result to the assistant, which uses it to generate the final answer." />
<div class="figcaption">Diagram showing the correct mental model for
tool calls: a user sends a request that needs a tool call, the assistant
requests that the user runs that tool, returns the result to the
assistant, which uses it to generate the final answer.</div>
</div>
<p>The value that the chat model brings is not in helping with
execution, but with knowing when it makes sense to call a tool, what
values to pass as arguments, and how to use the results in formulating
its response.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ellmer)</span></code></pre></div>
<div id="motivating-example" class="section level3">
<h3>Motivating example</h3>
<p>Let’s take a look at an example where we really need an external
tool. Chat models generally do not know the current time, which makes
questions like these impossible.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>chat <span class="ot">&lt;-</span> <span class="fu">chat_openai</span>(<span class="at">model =</span> <span class="st">&quot;gpt-4o&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>chat<span class="sc">$</span><span class="fu">chat</span>(<span class="st">&quot;How long ago did Neil Armstrong touch down on the moon?&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; Neil Armstrong touched down on the Moon on July 20, 1969. As of October 2023, </span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; that event occurred 54 years ago.</span></span></code></pre></div>
<p>Since the model doesn’t know what day it is, the result is
incorrect.</p>
</div>
<div id="defining-a-tool-function" class="section level3">
<h3>Defining a tool function</h3>
<p>The first thing we’ll do is define an R function that returns the
current time.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#&#39; Gets the current time in the given time zone.</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&#39; @param tz The time zone to get the current time in.</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&#39; @return The current time in the given time zone.</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>get_current_time <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>) {</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">tz =</span> tz, <span class="at">usetz =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>}</span></code></pre></div>
<p>Note that we’ve gone through the trouble of creating <a href="https://roxygen2.r-lib.org/">roxygen2 comments</a>. This isn’t
necessary, but as we’ll see shortly, can make it a bit easier to
generate a tool defintion.</p>
<p>To turn a function into a tool, we provide some additional metadata
that the model will use:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>get_current_time <span class="ot">&lt;-</span> <span class="fu">tool</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  get_current_time,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&quot;get_current_time&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">&quot;Returns the current time.&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">arguments =</span> <span class="fu">list</span>(</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    <span class="at">tz =</span> <span class="fu">type_string</span>(</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>      <span class="st">&quot;Time zone to display the current time in. Defaults to `</span><span class="sc">\&quot;</span><span class="st">UTC</span><span class="sc">\&quot;</span><span class="st">`.&quot;</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>      <span class="at">required =</span> <span class="cn">FALSE</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    )</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  )</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>)</span></code></pre></div>
<p>This is a fair amount of code to write, even for such a simple
function. Fortunately, you don’t have to write this by hand! I generated
the above <code>tool()</code> call by calling
<code>create_tool_def(get_current_time)</code>, which uses an LLM to
generate the <code>tool()</code> call for you.
<code>create_tool_def()</code> is not perfect, so you must review the
generated code before using it, but it is a big time-saver.</p>
<p>Note that a tool is just a special type of function so we can still
call it:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">get_current_time</span>()</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2025-06-25 16:53:23 UTC&quot;</span></span></code></pre></div>
</div>
<div id="registering-and-using-tools" class="section level3">
<h3>Registering and using tools</h3>
<p>Now we need to give our chat object access to our tool. We do this
with <code>$register_tool()</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>chat<span class="sc">$</span><span class="fu">register_tool</span>(get_current_time)</span></code></pre></div>
<p>That’s all we need to do! Let’s retry our query:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>chat<span class="sc">$</span><span class="fu">chat</span>(<span class="st">&quot;How long ago did Neil Armstrong touch down on the moon?&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; Neil Armstrong touched down on the Moon on July 20, 1969. As of June 25, 2025, </span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; that event occurred 55 years and approximately 11 months ago.</span></span></code></pre></div>
<p>That’s correct! Without any further guidance, the chat model decided
to call our tool function and successfully used its result in
formulating its response.</p>
<p>If we print the chat we can see where the model decided to use the
tool:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>chat</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; &lt;Chat OpenAI/gpt-4o turns=6 tokens=373/86 $0.00&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; ── user [19] ───────────────────────────────────────────────────────────────────</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; How long ago did Neil Armstrong touch down on the moon?</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; ── assistant [31] ──────────────────────────────────────────────────────────────</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; Neil Armstrong touched down on the Moon on July 20, 1969. As of October 2023, that event occurred 54 years ago.</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; ── user [108] ──────────────────────────────────────────────────────────────────</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; How long ago did Neil Armstrong touch down on the moon?</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; ── assistant [15] ──────────────────────────────────────────────────────────────</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; [tool request (call_olBG8OUjyIj914iwNBjw35dv)]: get_current_time(tz = &quot;UTC&quot;)</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; ── user [23] ───────────────────────────────────────────────────────────────────</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; [tool result  (call_olBG8OUjyIj914iwNBjw35dv)]: 2025-06-25 16:53:23 UTC</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; ── assistant [40] ──────────────────────────────────────────────────────────────</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Neil Armstrong touched down on the Moon on July 20, 1969. As of June 25, 2025, that event occurred 55 years and approximately 11 months ago.</span></span></code></pre></div>
<p>(Full disclosure: I originally tried this example with the default
model of <code>gpt-4o-mini</code> and it got the tool calling right but
the date math wrong, hence the explicit
<code>model=&quot;gpt-4o&quot;</code>.)</p>
<p>This tool example was extremely simple, but you can imagine doing
much more interesting things from tool functions: calling APIs, reading
from or writing to a database, kicking off a complex simulation, or even
calling a complementary GenAI model (like an image generator). Or if you
are using ellmer in a Shiny app, you could use tools to set reactive
values, setting off a chain of reactive updates.</p>
</div>
<div id="tool-inputs-and-outputs" class="section level3">
<h3>Tool inputs and outputs</h3>
<p>Remember that tool arguments come from the LLM, and tool results are
returned to the LLM. This implies that you should keep both as simple as
possible.</p>
<p>Inputs to a tool call, must be defined by
<code>type_boolean()</code>, <code>type_integer()</code>,
<code>type_number()</code>, <code>type_string()</code>,
<code>type_enum()</code>, <code>type_array()</code>, or
<code>type_object()</code>. We recommend keeping them as simple as
possible, focussing on basic scalar types as much as you can.</p>
<p>The output of the tool call will be interpreted by the LLM, just as
if you had typed that information into the data. That means you’ll
generally want to produce text or other atomic vectors. For more complex
data, ellmer will automatically serialize the result to JSON, which LLMs
generally seem to be good at understanding. If you must have more direct
control of the structure of the JSON that’s returned, you can return a
JSON-serializable value wrapped in <code>I()</code>, which ellmer will
leave alone until the entire request is JSON-serialized.</p>
<p>To show off these ideas, here’s a slightly more complicated example
simulating a weather API that returns data for multiple cities at once.
The <code>get_weather()</code> function returns a data frame that ellmer
will automatically convert into JSON in row-major format, which our
experiments suggest is good for LLMs.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>get_weather <span class="ot">&lt;-</span> <span class="fu">tool</span>(</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="cf">function</span>(cities) {</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    raining <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">London =</span> <span class="st">&quot;heavy&quot;</span>, <span class="at">Houston =</span> <span class="st">&quot;none&quot;</span>, <span class="at">Chicago =</span> <span class="st">&quot;overcast&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>    temperature <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">London =</span> <span class="st">&quot;cool&quot;</span>, <span class="at">Houston =</span> <span class="st">&quot;hot&quot;</span>, <span class="at">Chicago =</span> <span class="st">&quot;warm&quot;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    wind <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">London =</span> <span class="st">&quot;strong&quot;</span>, <span class="at">Houston =</span> <span class="st">&quot;weak&quot;</span>, <span class="at">Chicago =</span> <span class="st">&quot;strong&quot;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>      <span class="at">city =</span> cities,</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>      <span class="at">raining =</span> <span class="fu">unname</span>(raining[cities]),</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>      <span class="at">temperature =</span> <span class="fu">unname</span>(temperature[cities]),</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>      <span class="at">wind =</span> <span class="fu">unname</span>(wind[cities])</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    )</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  },</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&quot;get_weather&quot;</span>,</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">&quot;</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="st">    Report on weather conditions in multiple cities. For efficiency, request </span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="st">    all weather updates using a single tool call</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="st">  &quot;</span>,</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>  <span class="at">arguments =</span> <span class="fu">list</span>(</span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>    <span class="at">cities =</span> <span class="fu">type_array</span>(<span class="fu">type_string</span>(), <span class="st">&quot;City names&quot;</span>)</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>  )</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>)</span></code></pre></div>
<p>Now we register and use it:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>chat <span class="ot">&lt;-</span> <span class="fu">chat_openai</span>()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; Using model = &quot;gpt-4.1&quot;.</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>chat<span class="sc">$</span><span class="fu">register_tool</span>(get_weather)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>chat<span class="sc">$</span><span class="fu">chat</span>(<span class="st">&quot;Give me a weather udpate for London and Chicago&quot;</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; Here&#39;s the latest weather update:</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; - London: Heavy rain, cool temperatures, and strong winds.</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; - Chicago: Overcast skies, warm temperatures, and strong winds.</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; Let me know if you need a forecast for more cities or details!</span></span></code></pre></div>
<p>We can print the chat to confirm that the model only performed a
single tool call:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>chat</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; &lt;Chat OpenAI/gpt-4.1 turns=4 tokens=213/65 $0.00&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; ── user [74] ───────────────────────────────────────────────────────────────────</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; Give me a weather udpate for London and Chicago</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; ── assistant [17] ──────────────────────────────────────────────────────────────</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; [tool request (call_0epVfhsX7e8pEy0M1NaY9Vca)]: get_weather(cities = c(&quot;London&quot;, &quot;Chicago&quot;))</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; ── user [48] ───────────────────────────────────────────────────────────────────</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; [tool result  (call_0epVfhsX7e8pEy0M1NaY9Vca)]: [{&quot;city&quot;:&quot;London&quot;,&quot;raining&quot;:&quot;heavy&quot;,&quot;temperature&quot;:&quot;cool&quot;,&quot;wind&quot;:&quot;strong&quot;},{&quot;city&quot;:&quot;Chicago&quot;,&quot;raining&quot;:&quot;overcast&quot;,&quot;temperature&quot;:&quot;warm&quot;,&quot;wind&quot;:&quot;strong&quot;}]</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; ── assistant [48] ──────────────────────────────────────────────────────────────</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; Here&#39;s the latest weather update:</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; - London: Heavy rain, cool temperatures, and strong winds.</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; - Chicago: Overcast skies, warm temperatures, and strong winds.</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; Let me know if you need a forecast for more cities or details!</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
